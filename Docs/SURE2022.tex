\documentclass[11pt,reqno]{amsart}
\usepackage{mathptmx}
\usepackage{mathtools}
\usepackage{mathrsfs}
\usepackage[all]{xy}
\usepackage{stmaryrd}
\usepackage{fancyhdr}

\usepackage{pgf, tikz}
\usetikzlibrary{arrows, automata}

\usepackage{tikz-cd}
\usepackage{cite}
\usepackage{amsmath,amsfonts}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{array}
\usepackage{amsmath,amsthm,amssymb,hyperref}
\usepackage{exercise}

\usepackage{enumerate}
\usepackage{tikz}
\pagestyle{plain}
\usepackage[left=1.2in, right=1.2in, top=1in, bottom=1in]{geometry}
\usepackage{etoolbox}
\usepackage{color}
\patchcmd{\section}{\scshape}{\bfseries}{}{}
\makeatletter
\renewcommand{\@secnumfont}{\bfseries}
\makeatother
\xyoption{all}
\thispagestyle{empty}

\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\Spv}{Spv}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\Img}{Img}
\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\Pic}{Pic}
\DeclareMathOperator{\Div}{Div}
\DeclareMathOperator{\dv}{Div}
\DeclareMathOperator{\Deg}{deg}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\CSpec}{Cspec}
\newcommand{\angles}[1]{\langle #1 \rangle}
\newcommand{\Jac}{\textrm{Jac}}{}
\newcommand{\R}{\mathbb{R}}  
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\I}{\mathbf{I}}

\input xy
\xyoption{all}
\thispagestyle{empty}


%\usepackage{secdot} 

\theoremstyle{definition}
\newtheorem{mydef}{\textbf{Definition}}[section]
\newtheorem{myeg}[mydef]{\textbf{Example}}
\newtheorem{conj}[mydef]{\textbf{Conjecture}}
\newtheorem*{noconj}{\textbf{Conjecture}}
\newtheorem{observ}[mydef]{\textbf{Observation}}
\newtheorem{question}[mydef]{\textbf{Question}}
\newtheorem{rmk}[mydef]{\textbf{Remark}}
\newtheorem*{que}{\textbf{Question}}
\newtheorem*{goal}{\textbf{Goal}}

\theoremstyle{plain}
\newtheorem{mythm}[mydef]{\textbf{Theorem}}
\newtheorem*{nothm}{\textbf{Theorem}}
\newtheorem*{nomainthm}{\textbf{Main Theorem}}
\newtheorem*{nothma}{\textbf{Theorem A}}
\newtheorem*{nothmb}{\textbf{Theorem B}}
\newtheorem*{nothmc}{\textbf{Theorem C}}
\newtheorem*{nothmd}{\textbf{Theorem D}}
\newtheorem*{nothme}{\textbf{Theorem E}}
\newtheorem*{nothmf}{\textbf{Theorem F}}
\newtheorem*{nothmg}{\textbf{Theorem G}}
\newtheorem{mytheorem}[mydef]{\textbf{Theorem}}
\newtheorem{lem}[mydef]{\textbf{Lemma}}
\newtheorem{pro}[mydef]{\textbf{Proposition}}
\newtheorem{claim}[mydef]{\textbf{Claim}}
\newtheorem{cor}[mydef]{\textbf{Corollary}}
\newtheorem{con}[mydef]{\textbf{Construction}}


\patchcmd{\abstract}{\scshape\abstractname}{\normalsize{\textbf{\abstractname}}}{}{}
\begin{document}


\title{On Picard groups of directed graphs}
%

\author{Jaiung Jun}
\address{Department of Mathematics, State University of New York at New Paltz, NY 12561, USA}
\email{junj@newpaltz.edu}

\author{Matthew Pisano}
\address{Department of Mathematics, State University of New York at New Paltz, NY 12561, USA}
\email{pisanom1@newpaltz.edu}


%

%
\makeatletter
\@namedef{subjclassname@2020}{%
	\textup{2020} Mathematics Subject Classification}
\makeatother

\subjclass[2020]{05C50, 05C76}
\keywords{Jacobian of a graph, sandpile group, critical group, chip-firing game, gluing graphs, cycle graph, Tutte
	polynomial, Tutte's rotor construction}
%\thanks{}

\begin{abstract}

\end{abstract}

\maketitle


\section{Introduction}

	We will focus on Research Project 11 in~\cite{glass2020chip}.
	The following are more specific directions that we plan to pursue.

	\begin{goal}[8/1/2022]$ $
		\begin{enumerate}
			\item
			Prove/disprove: for an oriented graph $G$, one always has $\Pic(G)=\mathbb{Z} \times \Jac(G)$, 
			i.e., as a finitely generated abelian group, the rank of $\Pic(G)$ is $1$.
			\textcolor{red}{Jaiung: we disproved this by using~\cite{wagner2000critical}.}
			\item
			Prove/disprove: for $C_n$, and $0 \leq m \leq n$, one can always find an orientation
			of $C_n$ so that $\Jac(C_n)=\mathbb{Z}_m$ (with the orientation).
			\item
			Prove/disprove: for an oriented graph $G$, if $v_0 \in V(G)$ is a sink (or a source)
			and $G'$ is the graph obtained by reserving the direction for all arrows adjacent
			to $v_0$ from $G$, then $\Jac(G)=\Jac(G')$. (Note: we believe that this should be true
			for at least some classes of graphs such as cyclic graphs.)
			\item
			Prove/disprove: for an oriented planar graph $G$ and its planar dual (should be defined)
			$\hat{G}$, one has $\Jac(G)=\Jac(\hat{G})$.
			\item
			Prove/disprove: for oriented graphs $G_1,G_2$, let $G$ be the graph obtained by
			gluing $G_1$ and $G_2$ along one vertex. Then $\Jac(G)=\Jac(G_1) \times \Jac(G_2)$.
			\textcolor{red}{Jaiung: we are currently working on this (8/31)}
		\end{enumerate}
	\end{goal}

\bigskip

\textbf{Acknowledgment}\hspace{0.1cm} This research was supported by Research and Creative Activities (RSCA) at
	SUNY New Paltz. We would like to thank RSCA for their support.

\section{Preliminaries}
	\subsection{Chip Firing}
		The game at the heart of this paper is the Chip-Firing game. When a game is started, each vertex on
		a graph is assigned a certain number of chips.  During play, chips can be lent or borrowed at each
		node where one or more chips are either sent or received along each outgoing edge equally.  In the
		case of a directed graph, vertices can only interact with another along an outgoing or
		bidirectional edge.  The game is won once every vertex has a positive number of chips (i.e., this
		vertex is not in debt).

	\subsection{Divisors and Equivalence Relations}
		In the study of this game a \textbf{Divisor} of a graph ($\Div(G)$) is an integer vector $v\in\mathbb{Z}^n$
		where \textit{n} is the number of vertices in the graph.  The $i^{th}$ element of the vector \textit{v}
		is the number of chips on the $i^{th}$ vertex of the graph.  Two divisors have an \textbf{Equivalence Relation}
		($\sim$) if one divisor can be gotten from the other by a finite series of lending or borrowing moves
		$D_1 \sim D_2 \xleftrightarrow{} (D_1 \xleftrightarrow{\text{moves}} D_2)$.  An \textbf{Equivalence Class} \textit{[D]}
		is the set of all divisors that are equivalent to each other, $[D] = \{D_i~|~D_i \sim D\}$.

	\subsection{The Picard Group and The Jacobian}
		The \textbf{Picard Group} of a graph $\Pic(G)$ is the set of all equivalence classes that the
		divisors of that graph can be a  part of. The \textbf{Jacobian} of a graph  $\Jac(G)$ is a subset
		of $\Pic(G)$ such that every divisor in each equivalency class has a degree of $0$ where the
		degree of a divisor $\Deg(D)$ is the sum of each of the divisor's elements.
		If a divisor is in one of the Jacobian's classes, it can be made winning after a finite series of moves.


\section{Propositions}
	\subsection{Calculating Sinks and Sources}
		Vertices on a directed graph can be classified in three ways, as a sink, source, or neither depending on
		the direction of the edges connected to it.  A sink is a vertex where all edges are directed into that vertex,
		a source is a vertex where all edges are directed away from that vertex and a vertex is neither
		when it has a mixture of the two.  The number of sinks
		and sources can be calculated inductively by reconstructing the original graph from a single vertex.

		Beginning with any two vertices that are adjacent on the original graph, observe their connecting edge.
		If the edge is directed, the count of sinks and sources begins at 1 for both.  If the edge
		is undirected (bidirectional), the count begins at zero. Next, pick a vertex adjacent to one of the original
		edges and observe its connection.  From this point on, when a new edge is observed the number of sinks and
		sources changes on a series of rules.  For these rules, let the vertex being added to be $V_1$ and
		the vertex being added be $V_2$.
		\begin{enumerate}
			\item If $V_1$ is neither a sink nor a source.
			\begin{enumerate}
				\item Adding an edge directed towards $V_2$ adds a sink.
				\item Adding an edge directed away from $V_2$ adds a source.
				\item Adding a bidirectional edge between $V_1$ and $V_2$ adds nothing.
			\end{enumerate}
			\item If $V_1$ is a source.
			\begin{enumerate}
				\item Adding an edge directed towards $V_2$ adds a sink.
				\item Adding an edge directed away from $V_2$ adds nothing (Here the number of sources stays
					\label{itm:noChange}
					the same as $V_1$ is no longer a source but $V_2$ now is).
				\item Adding a bidirectional edge between $V_1$ and $V_2$ removes a source.
			\end{enumerate}
			\item If $V_1$ is a sink.
			\begin{enumerate}
				\item Adding an edge directed towards $V_2$ adds nothing (See~\ref{itm:noChange}).
				\item Adding an edge directed away from $V_2$ adds a source.
				\item Adding a bidirectional edge between $V_1$ and $V_2$ removes a sink.
			\end{enumerate}
		\end{enumerate}
		When accounting for a vertex that has multiple connections, apply these rules for every $V_{1i}$ that $V_2$
		is connected to, taking into account all the edges of $V_2$ when evaluating its class.  After every vertex has
		been accounted for, the number of sinks and sources will have been calculated in polynomial time between $O(n)$
		at the average case and $O(n^2)$ for the case of a connected graph.

	%\subsection{Using Sinks and Sources to Calculate $Rank(\Pic(G))$}
	%	$\Pic(G)$ is often in the form $\mathbb{Z}_1 \times \dots \times \mathbb{Z}_n \times \mathbb{Z}^m$ where $m$ is
	%	the rank of the picard group.  When calculating $\Pic(G)$, its $Rank()$ is closely correlated with the number
	%	of sinks and sources of the graph.  $Rank(\Pic(G))$ appears to always either
	%	in $range(sources, sinks)$ (inclusive) or one greater than $\max(sources, sinks)$.

	%~\cite[Corollary 3.5]{wagner2000critical}

\section{Example: Trees}

	\begin{lem}
		Let $G$ be a graph with any orientation. If we attach either an incoming arrow or a two-sided
		arrow to create a directed graph $G'$, then $\Pic(G)=\Pic(G')$. \label{proposition: gluing an arrow proposition}
	\end{lem}
	\begin{proof}
		Let $\alpha$ be an arrow which is glued to $G$. Let $|V(G)|=n$. We label the vertexes of
		$G$ as $1,2,\dots,n$. Suppose first that $\alpha$ is incoming and $\alpha$ is glued at the vertex $n$.
		Let $A_G=(a_{ij})$ (resp.~$A_{G'}$) be the Laplacian of $G$ (resp.~$G'$). In this case, one can easily
		observe that the matrix $A_{G'}$ is of the following form:
		\begin{equation}
			A_{G'}=\left[\begin{array}{ccc|c|c}
				a_{11}&a_{12}&\cdots &a_{1n}&0\\
				a_{21}&a_{22}&\cdots &a_{2n}&0\\
				\vdots & \vdots &\ddots & \vdots & \vdots \\ \hline
					\vdots & \vdots & \cdots&a_n & 0\\ \hline
				0&0&\cdots &-1&1\\
			\end{array}\right]
		\end{equation}
		By a column operation between the last two columns, we obtain the following matrix:
		\begin{equation}\label{eq: arrow adding matrix}
			\left[\begin{array}{ccc|c|c}
				a_{11}&a_{12}&\cdots &a_{1n}&0\\
				a_{21}&a_{22}&\cdots &a_{2n}&0\\
				\vdots & \vdots &\ddots & \vdots & \vdots \\ \hline
				\vdots & \vdots & \cdots&a_n & 0\\ \hline
				0&0&\cdots &0&1\\
			\end{array}\right]
		\end{equation}
		This shows that $\Pic(G)=\Pic(G')$.

		Next, suppose that $\alpha$ is a two-sided arrow. Then similar to the above, we obtain the following matroid for $G'$:
		\begin{equation}\label{eq: eq two-sided}
			A_{G'}=\left[\begin{array}{ccc|c|c}
				a_{11}&a_{12}&\cdots &a_{1n}&0\\
				a_{21}&a_{22}&\cdots &a_{2n}&0\\
				\vdots & \vdots &\ddots & \vdots & \vdots \\ \hline
				\vdots & \vdots & \cdots&a_n+1 & -1\\ \hline
				0&0&\cdots &-1&1\\
			\end{array}\right]
		\end{equation}
		By a column operation, the matrix~\eqref{eq: eq two-sided} becomes the matrix~\eqref{eq: arrow adding matrix}.
		This shows that $\Pic(G)=\Pic(G')$.
	\end{proof}

	\begin{pro}
		Let $T$ be a tree with any orientation. Then $\Pic(T)=\mathbb{Z}^n$, where $n$ is the number of sinks of $T$.
	\end{pro}
	\begin{proof}

		Note that from~\cite[Corollary 3.5]{wagner2000critical} that the rank of $\Pic(T)$ is the number of sinks of $T$.

		Now, we can inductively prove this. When $T_0$ is a tree with one arrow, one can easily check that
		$\Pic(T_0) =\mathbb{Z}$ or $\{0\}$ (depending on the number of sinks). Suppose that $T_k$ is a directed tree
		with $k$ arrows. When we add one arrow $\alpha$ to $T_k$ to construct $T_{k+1}$, there are three cases; $(1)$ incoming,
		$(2)$ outgoing, and $(3)$ two-sided. When $\alpha$ is either incoming or two-sided arrow, then it follows from Lemma
		~\ref{proposition: gluing an arrow proposition} that $\Pic(T_k)=\Pic(T_{k+1})=\mathbb{Z}^n$, where $n$ is the
		number of sinks of $T_k$ and $T_{k+1}$, since in this case it does not increase the number of sinks.

		Next, suppose that $\alpha$ is an outgoing arrow. In this case, $T_{k+1}$ has one more sink than $T_{k}$.
		We claim that $\Pic(T_{k+1})=\Pic(T_k)\times \mathbb{Z}$. We label the vertexes of $G$ as $1,2,\dots,n$ and
		suppose that the arrow $\alpha$ is attached to the vertex $n$. Let $A_{T_k}=(a_{ij})$ be the Laplacian of $T_k$.
		Then we have the following:
		\begin{equation}\label{eq: tree case}
			A_{T_{k+1}}=\left[\begin{array}{ccc|c|c}
				a_{11}&a_{12}&\cdots &a_{1n}&0\\
				a_{21}&a_{22}&\cdots &a_{2n}&0\\
				\vdots & \vdots &\ddots & \vdots & \vdots \\ \hline
				\vdots & \vdots & \cdots&a_n+1 & -1\\ \hline
				0&0&\cdots &0&0\\
			\end{array}\right]
		\end{equation}
		\textcolor{red}{Jaiung: I will finish writing down the proof before our next meeting.}
	\end{proof}

\section{Example: Cycles}

	Here's our conjecture:
	\begin{conj}
		Let $C_n$ be the cycle graph with $n$ vertices. For each $k \leq n$, there exists an orientation of $C_n$
		such that $\Jac(C_n)$ (with that orientation) is $\mathbb{Z}_k$.
	\end{conj}

	The following examples shows the conjecture for $C_3$.

	\begin{myeg}
		%cycle = Graph.cycle(3)
		%cycle.setEdgeState(0, 1, 2)
		%cycle.setEdgeState(1, 2, 2)
		%cycle.setEdgeState(2, 0, 2)
		%Trivial

		%cycle = Graph.cycle(3)
		%cycle.setEdgeState(0, 1, 0)
		%cycle.setEdgeState(1, 2, 0)
		%cycle.setEdgeState(2, 0, 0)
		%Z_3

		%cycle = Graph.cycle(3)
		%cycle.setEdgeState(0, 1, 1)
		%cycle.setEdgeState(1, 2, 2)
		%cycle.setEdgeState(2, 0, 2)
		%Z_2
	\end{myeg}

	\begin{lem}
		Let $C_n$ be the cycle graph with $n$ vertices. Consider the orientation of $C_n$ which provides precisely
		two directed paths in opposite direction. All invariant factors of $\Jac(G)$, where $G = C_n$, can
		be represented in the Jacobian of that graph using two directed paths.
	\end{lem}
	\begin{proof}
		Beginning with a non-oriented cyclic graph, $\Jac(G) = \mathbb{Z}_n$.
		Orienting one edge $(x, x+1)$ in the counter-clockwise direction, another edge $(x-1, x)$ to clockwise,
		and $(x+1, x+2)$ to counter-clockwise yields a Jacobian of $\mathbb{Z}_{n-1}$.
		Orienting either the edge before $(x-1, x)$ to clockwise or the edge after $(x+1, x+2)$ to
		counter-clockwise yields $\Jac(G) = \mathbb{Z}_{n-2}$.  Continuing this pattern until the two paths
		meet yields all invariant factors down to $\mathbb{Z}_2$.  Going further to orient the entire
		graph to one direction results in a trivial Jacobian of ${0}$.This pattern should hold for all
		cycle graphs $C_3 \dots C_x$, and had been proven for graphs $C_3 \dots C_{80}$.
	\end{proof}

	The following example shows that the rank of $\Pic(C_n)$ (with an orientation) does not have to be $1$;
	this directly follows from~\cite[Corollary 3.5]{wagner2000critical}.

	\begin{myeg}
		%cycle = Graph.cycle(9)
		%cycle.setEdgeState(0, 1, 0)
		%cycle.setEdgeState(1, 2, 1)
		%cycle.setEdgeState(2, 3, 1)
		%cycle.setEdgeState(3, 4, 2)
		%cycle.setEdgeState(4, 5, 2)
		%cycle.setEdgeState(5, 6, 1)
		%cycle.setEdgeState(6, 7, 1)
		%cycle.setEdgeState(7, 8, 2)
		%cycle.setEdgeState(8, 0, 2)
		%Rank(Pic(G)) = 2: 2 terminal strong components
	\end{myeg}

	\subsection{Calculating Rank($(\Pic(G)$) Using Terminal Strong Components}
		$\Pic(G)$ is often in the form $\mathbb{Z}_1 \times \dots \times \mathbb{Z}_n \times \mathbb{Z}^m$ where $m$ is
		the rank of the picard group.  A terminal strong component describes itself well.  It is a terminal component,
		meaning that its only connections are edges directed into it.  It is also strongly connected, meaning that every
		vertex in the component has at least one path to all other components.  For cycle graphs and trees, the number
		of these terminal strong components is exactly equal to $Rank(\Pic(G))$.

		\begin{proof}
			The $Rank(\Pic(G))$ comes directly from the number of all zero rows of the Smith Normal Form of the laplacian of
			$G$.  Terminal strong components are either already zero rows (in the case of a single sink) or there
			exists a series of row and column operations that, when preformed on the laplacian result in a row of all
			zeroes.
		\end{proof}

	\begin{lem}
		Let $C_n$ be the cycle graph with $n$ vertices. Consider the equi-orientation of $C_n$.
		Then $\Pic(C_n)=\mathbb{Z}$.
	\end{lem}
	\begin{proof}
		In this case $C_n$ will always have a laplacian with a diagonal of $1$ and a diagonal of $-1$
		above or below it depending on the orientation, with another $-1$ in the top right or bottom left corner
		where $V_0$ connects $V_{n-1}$.  Turing this laplacian into a smith normal form of all $1$s is as simple as
		cascading additions from the first row in a counter-clockwise case and the last row in the clockwise case.
		This will result in a diagonal of ones with the first or last column made up of mostly $-1$.  From here
		all that needs to be done is to eliminate these with the first or last row.  Since each equi-oriented $C_n$
		will follow this pattern, this algorithm will prove $\Pic(C_n)=\mathbb{Z}$ for all $C_n$.
	\end{proof}

\section{Example: Pseudotrees}

	\textcolor{red}{Jaiung: here we study how Picard groups change when we glue two directed graphs along one vertex or
		connect two graphs along one arrow. If we are lucky this should provide a way to compute Picard groups for
		pseudotrees by using the tree case and the cycle case in the previous sections.}

\section{Strongly connected directed graphs}

\bibliography{Jacobian}
\bibliographystyle{alpha}

\end{document}
